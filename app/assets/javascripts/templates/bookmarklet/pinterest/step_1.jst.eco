<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link href="<%= @cssUrl %>" media="all" rel="stylesheet" type="text/css" />
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
</head>
<body>
    
<% partial_PinterestBoard = (board) => %>
  <li class="board-<%= board.id %>">
    Pinterest Board: <%= board.name %>
  </li>
<% end %>

<% partial_PinterestPin = (board, pin) => %>
  <li class="pin board-all board-<%= board.id %>" data-pin-id="<%= pin.id %>">
    <div class="thumb">
      <img src="<%= pin.smallImageURL %>" alt="Pin Image">
    </div>
    <div class="clearfix"></div>
  </li>
<% end %>


<div id="pp_pinterest_import_wrapper">
  
  <div id="pinterest_section">
    <div class="importing_boards">
      <ul>
        <li class="board-all selected">
          Show All Pins
        </li>
        <% for board in @boards: %>
          <%= partial_PinterestBoard(board) %>
        <% end %>
      </ul>      
    </div>
    
    <div class="importing_pins">
      <ul>
        <% for board in @boards: %>        
          <% for pin in board.pins: %>
            <%= partial_PinterestPin(board, pin) %>
          <% end %>
        <% end %>
      </ul>
    </div>

    <div class="clearfix"></div>
  </div>

  <div id="our_section">
    <div class="loading">Retreiving your boards...</div>
  </div>

  <div id="buttons_section">
    <a href="#" onclick="return false;" id="ppTogglePreviouslyImportedLink" style="display:none;">Hide Previously Imported</a>

    <div class="right">
      <a href="#" onclick="return false;" id="ppSubmitBoardsSortedLink">Import These Pins</a>
    </div>
  </div>

  
  
  
  
</div>
<script type="text/javascript">
   if (window.parent && window.parent.ppImporter) {     
     // http://bugs.jqueryui.com/ticket/5727 -- draggable in child window doesn't work when initialized from parent document. Have to load jquery + jquery UI here to compensate.
     window.initializeDraggableFromParent = function(commands) {
       for (var i=0; i < commands.length; i++) {
         jQuery(commands[i][0], this.document)[commands[i][1]](commands[i][2]);
       }
     };
     
     window.parent.ppImporter.stepOneIframeLoaded();
   }
</script>
</body>
</html>
